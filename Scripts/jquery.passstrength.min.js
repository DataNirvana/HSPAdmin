!function($){$.fn.passStrengthify=function(options){var $el=$(this),$out_el,presets=[[0,8,16,32,48,64,72],[0,16,32,48,64,78,92],[0,32,64,78,92,108,128]],levelJSObj="passwordLevel",levels=["Very weak","Very weak","Weak","Weak","Moderate","Good","Strong","Very strong"],colours=["gray","red","red","#C00000","orange","#0099FF","blue","green"],tests=presets[0],text=$("<span>").css("margin-left","1em"),progress_blocks=[],i=0,minimum=0,rawEntropy=!1,makeOutput=function(e,t,s){var o,n,r,a,l=progress_blocks.length;for(a=s?options.labels.tooShort:rawEntropy?Math.round(100*t)/100+" bits":levels[e],r=colours[e],o=colours[e],n=colours[0],text.text(a).css("color",r),i=0;l>i;i++)progress_blocks[i].css("background-color",e>i?o:n)},regexTest=function(e,t){return-1!=t.search(e)},charEntropy=function(e,t,s){var o=e.charAt(t),n=[.08064249900208098,.015373768624831691,.026892340312538593,.04328667139002636,.1288623426065769,.0244847137116921,.019625534749730816,.06098726796371807,.06905550211598431,.0011176940633901926,.006252182367878119,.04101676132771116,.02500971934780021,.06984975410235668,.07378315126621263,.017031440203182008,.0010648594165322703,.06156572691936394,.063817324270356,.09024664994930598,.0278568510204016,.010257964235274787,.021192261444145363,.0016941732664605912,.01806326249861108,.0009695838238376564],r=[.11617102232902775,.04708120556723741,.035155702413137084,.02673475518173626,.020026033843997197,.0378391909482327,.01952538299789727,.07241413837989387,.06294182437168319,.006318213677781116,.006908981676179033,.027085210774006212,.04379693601682187,.02368078502052669,.06272153799939922,.025483128066486435,.0004305597276459397,.016551516972063685,.07765094623009913,.16692700510663863,.014889356163011918,.006198057474717133,.06669670571743266,50065084609993e-18,.01622108741363773,.00050065084609993],a=[2835e-7,.0228302,.0369041,.042629,.0012216,.0075739,.0171385,.0014659,.0372661,2353e-7,.0110124,.0778259,.0260757,.2145354,5459e-7,.0195213,1749e-7,.110477,.093429,.131796,.0098029,.0306574,.0088799,9562e-7,.0233701,.0018701,.0580027,.0058699,791e-7,.0022625,.3416714,2057e-7,4272e-7,3639e-7,.0479084,.0076894,0,.115056,.0012816,3481e-7,.0966553,158e-7,0,.0740301,.0226884,.010743,.1196127,.001155,316e-7,0,.0864502,0,.1229841,271e-7,.0215451,5246e-7,.1715916,9e-6,0,.1701716,.056549,0,.0453966,.0488879,0,362e-7,.1759242,9e-6,.0017185,.0376812,.0010492,.0906756,.0358361,0,0,0,.0041969,9e-6,.0280345,5057e-7,2585e-7,.0081086,.1224833,6799e-7,.0054844,708e-6,.0794902,3484e-7,1911e-7,.0092662,.0021466,.0030456,.0397283,163e-6,225e-7,.0178918,.0307037,9159e-7,.0178805,.0027759,.0013655,0,.0076478,0,.0545873,.0012798,.0224322,.0843434,.0317097,.008564,.0052834,.0017762,.0127186,2605e-7,.0010967,.0339975,.0186268,.0815271,.0032334,.0101307,.0021424,.1307517,.0712793,.0241537,.0014289,.0157312,.0070879,.0105139,.0125997,1831e-7,.0638579,2384e-7,3179e-7,2086e-7,.0928264,.0500293,199e-7,993e-7,.0820576,0,199e-7,.0266638,397e-7,894e-7,.1545186,1689e-7,99e-7,.0825344,.0039539,.034194,.0334986,99e-7,1987e-7,0,.00152,0,.0592435,3842e-7,5205e-7,.0020078,.1482326,2727e-7,.0101631,.1420108,.0501091,248e-7,372e-7,.0395122,.002987,.0127906,.0573224,5577e-7,0,.0884686,.0261142,.0062466,.0256309,372e-7,347e-6,0,.003272,1363e-7,.1580232,7737e-7,.002046,5185e-7,.4597035,4627e-7,359e-7,718e-7,.1252667,0,4e-6,.0014278,.0013042,.0012922,.0700557,439e-7,3191e-7,.0117178,.0022056,.0297253,.0131497,0,.001029,0,.0072309,0,.0166996,.0069144,.0486793,.0363474,.0480664,.0271435,.0307856,775e-7,4826e-7,35e-7,.0073125,.0526842,.0412929,.2618995,.0497818,.0062698,4333e-7,.043762,.1157982,.1198384,701e-6,.0235788,211e-7,.001881,0,.0032265,.2106638,0,0,0,.190642,0,0,0,4353e-7,0,0,0,0,0,.2644178,0,0,0,0,0,.3299238,0,0,0,2176e-7,0,.0169234,.0011671,5058e-7,.0017118,.3321662,.0041628,4669e-7,7781e-7,.1300965,0,3112e-7,.0185963,9726e-7,.100957,.0113601,.001206,0,4279e-7,.0613523,.0022954,.0029956,0,.0041239,0,.0086757,0,.10168,5515e-7,.0020459,.0668636,.1657445,.0134024,.0011801,1542e-7,.1107889,119e-7,.0053728,.135518,.0055389,9726e-7,.0826499,.0022654,59e-7,.0018443,.0230153,.0180635,.0144461,.004163,.0025797,0,.0968765,237e-7,.1539307,.0285939,1653e-7,.0025384,.2496134,.0017798,195e-7,3015e-7,.0877464,195e-7,0,.0015756,.0221846,.0029567,.1098532,.0485124,0,.016991,.0249954,8461e-7,.0385435,292e-7,1167e-7,0,.0505257,0,.0240107,5432e-7,.0423173,.1767352,.0849166,.0053036,.1188694,.0028799,.0295789,.0012223,.0071353,.0087755,6582e-7,.0085073,.0653564,3343e-7,9716e-7,4144e-7,.0427003,.0956004,.0093814,.00335,8497e-7,3343e-7,.012115,1288e-7,.0083175,.0072923,.0127087,.0203076,.0029439,.1135873,.0060659,.0018527,.0087857,1978e-7,.0106912,.0268647,.0580447,.1459838,.0330625,.0138659,2308e-7,.1175433,.032268,.0492657,.1337201,.0164801,.0488371,5374e-7,.0033923,8571e-7,.1284508,4427e-7,4427e-7,4713e-7,.2213542,1428e-7,857e-7,.0221226,.0538854,286e-7,1143e-7,.0957597,.0010854,5856e-7,.1212242,.0607692,0,.1362487,.0222939,.0408603,.0270926,0,.0011711,0,.0042274,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2284e-7,2284e-7,0,.9949749,0,0,0,0,0,.0733524,.0032081,.0116789,.028407,.234553,.0056616,.0107385,.0026432,.0792432,435e-7,.0087196,.0117263,.0192448,.0221961,.0919374,.0048043,316e-7,.0189406,.0459213,.0421561,.0173721,.0070603,.0019873,4e-6,.0284504,.0055945,.0349781,6441e-7,.0157796,.0015208,.1179849,.0010558,4688e-7,.0569819,.0506053,495e-7,.005378,.0114497,.006552,.0022488,.0491264,.0287844,8309e-7,1906e-7,.0463897,.1269191,.0330152,8e-5,.0053856,0,.0020925,0,.0393295,159e-6,.0037195,674e-7,.0892434,9218e-7,404e-7,.3352928,.0666758,54e-7,162e-7,.0146273,911e-6,.0011051,.0913053,809e-7,27e-7,.0310281,.0245378,.0171177,.0185732,27e-7,.0078702,0,.0121422,2776e-7,.0261517,.0181796,.0459729,.0223272,.0308931,.0058765,.0505571,699e-7,.0298191,87e-7,1572e-7,.1066327,.0308669,.1156002,.002017,.0448465,1746e-7,.1626908,.1207345,.1249869,349e-7,9343e-7,2008e-7,8819e-7,2969e-7,.0010042,.1022242,0,0,.0049559,.6796927,0,0,2371e-7,.1467561,0,0,1423e-7,0,.0128284,.0429195,0,0,8299e-7,3083e-7,0,.0025847,5928e-7,0,0,.0038888,0,.1832539,3329e-7,2984e-7,.0018938,.1605624,.0013085,344e-7,.1893372,.1788924,0,505e-6,.0089412,2755e-7,.0372798,.0933831,803e-7,115e-7,.0082066,.0126485,.0018135,.0011707,0,3214e-7,0,6887e-7,0,.0600144,0,.1573582,.001005,.05542,0,1436e-7,.0132089,.1122757,0,0,.0014358,1436e-7,0,.0055994,.2157933,.0031587,0,.0027279,.2360373,.0195262,.0051687,1436e-7,.0093324,.0020101,0,.0072178,.0039321,.0011985,.0020738,.0562745,.0015217,3097e-7,7137e-7,.0141393,135e-7,269e-7,.0031914,.0039051,.0022488,.1205478,.0027875,0,.0048882,.0324935,.0109613,5925e-7,673e-7,.0016025,1347e-7,943e-7,202e-6,.4219769,7526e-7,.0060211,.0067737,.3038133,0,0,5018e-7,.0709985,2509e-7,0,.0198194,0,0,.0730055,0,0,2509e-7,.0017561,5018e-7,.0037632,.0010035,0,0,.0100351,.026844],l={1:"l",3:"e",4:"a",5:"s",7:"t","@":"a",$:"s"};if("undefined"!=typeof l[o]&&(o=l[o]),!o.match(/^[a-zA-Z]$/))return 1/s;var p,i=o.toLowerCase().charCodeAt(0)-"a".charCodeAt(0),c=null;t&&(c=e.charAt(t-1),"undefined"!=typeof l[c]&&(c=l[c]));var u=null!=c&&c.match(/^[a-zA-Z]$/);if(u){var h;h=c.toLowerCase().charCodeAt(0)-"a".charCodeAt(0),p=a[i+26*h]}else{var g=t?n:r;p=g[i]}return s>=26&&(p*=26/s),p},calculateEntropy=function(e){var t=0,s={"[a-z]":26,"[A-Z]":26,"(\\d[^\\d])|(^\\d+$)":10,"[\\W_]":32};if(e=e.replace(/(.)(\1)(\1)+/gi,"$1$2"),e=e.replace(/(a)(b(c(d(e(f(g(h(i(j(k(l(m(n(o(p(q(r(u(v(w(x(y(z)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?)?/gi,"$1"),e=e.replace(/(0)(1(2(3(4(5(6(7(8(9)?)?)?)?)?)?)?)?)?/g,"$1"),e=e.replace(/(1)(2(3(4(5(6(7(8(9(0)?)?)?)?)?)?)?)?)?/g,"$1"),e=e.replace(/([^\d])(\d)(\d)+$/,"$1$2"),!e.length)return 0;for(var o in s)regexTest(new RegExp(o),e)&&(t+=s[o]);if(!t)return 0;for(var n=0,r=0;r<e.length;r++){var a=charEntropy(e,r,t);n+=Math.max(-7,Math.log(a)/.6931471805599453)}return-1*n},test=function(e){var t=0,s=0;if(s=calculateEntropy(e),tests.length&&tests[0]instanceof RegExp)jQuery.each(tests,function(s,o){t+=regexTest(o,e)});else for(i=0;i<tests.length&&!(s<tests[i]);i++)t=i+1;return[s,t]},change=function(e){var pass=$(this).val(),tooshort=!pass.length||pass.length<minimum,entropy,passes,a;a=test(pass),entropy=a[0],passes=tooshort?0:a[1];try{eval(levelJSObj+" = passes;")}catch(exp){}makeOutput(passes,entropy,tooshort)};return"undefined"==typeof options&&(options={}),"undefined"==typeof options.labels&&(options.labels={}),options.labels=$.extend({tooShort:"Too short",passwordStrength:"Password strength:"},options.labels),$out_el=$("<span>").css("display","inline-block").addClass("PassStrengthify"),$(this).each(function(){options.element?options.element.append($out_el):$(this).parent().append($out_el),options.minimum&&(minimum=options.minimum),options.levelJSObj&&(levelJSObj=options.levelJSObj),"undefined"==typeof options.security&&(options.security=1),options.security>=0&&options.security<presets.length&&(tests=presets[options.security]),options.levels||(options.levels=levels),options.colours||(options.colours=colours),options.tests||(options.tests=tests),options.levels&&options.colours&&options.tests&&options.levels.length==options.colours.length&&options.colours.length==options.tests.length+1&&(levels=options.levels,colours=options.colours,tests=options.tests),options.rawEntropy&&(rawEntropy=!0),$out_el.append($("<div>").append($("<span>").text(options.labels.passwordStrength).append(text)));var e=190,t=3,s=Math.round((e-t*tests.length)/tests.length);for(i=0;i<tests.length;i++){var o=$("<span>").css("height","4px").css("width",s+"px").css("margin-right",t+"px").css("max-height","4px").css("font-size","1px").css("float","left");progress_blocks.push(o),$out_el.append(o)}$el.keypress(change),$el.keyup(change),$el.trigger("keyup")})}}(jQuery);